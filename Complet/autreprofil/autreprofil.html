<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profil Utilisateur</title>
    <link rel="stylesheet" href="../CSS/autreprofil.css">
</head>
<body>
    <div id="sidebar">
        <div class="logo">
            <a href="../HTML/accueil_apres_connexion.html"><img src="../Images/logobao.png" alt="Logo du site"></a>
        </div>
        <nav class="categorie">
            <ul>
                <li><a href="../HTML/accueil_apres_connexion.html">Accueil</a></li>
                <li><a href="#">Recherche</a></li>
                <li><a href="#">Produit</a></li>
                <li><a href="#">Messagerie</a></li>
                <li><a href="#">Profil</a></li>
            </ul>
        </nav>
        <div class="connexion">
            <a href="../PHP/logout.php">Déconnexion</a>
        </div>
    </div>
    <div id="profil">
        <h1>Profil de <span id="pseudo"></span></h1>
        <img id="image" src="" alt="Photo de profil">
        <p>Age : <span id="age"></span></p>
        <p>Sexe : <span id="sexe"></span></p>
        <p>Date de naissance : <span id="dateNaissance"></span></p>
        <p>Pays : <span id="pays"></span></p>
        <p>Description de la situation : <span id="description"></span></p>
        <p>Taille : <span id="taille"></span></p>
        <p>Poids : <span id="poids"></span></p>
        <p>Intérêt 1 : <span id="interet1"></span></p>
        <p>Sport : <span id="sport"></span></p>
        <p>Couleur des cheveux : <span id="couleurCheveux"></span></p>
        <p>Couleur des yeux : <span id="couleurYeux"></span></p>
        <div id="Prive">
            <h2>Informations privées</h2>
            <p>Nom complet : <span id="nomComplet"></span></p>
            <p>Adresse : <span id="adresse"></span></p>
        </div>
    </div>
    <footer>
        &copy; 2024 Site de Rencontre. Tous droits réservés.
    </footer>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var userProfile = localStorage.getItem('userProfile');
            if (userProfile) {
                var user = JSON.parse(userProfile);
                document.getElementById('pseudo').innerText = user.pseudo;
                document.getElementById('image').src = '../' + user.imagePath;
                document.getElementById('image').alt = "Photo de profil de " + user.pseudo;
                document.getElementById('age').innerText = user.age;
                document.getElementById('sexe').innerText = user.sexe;
                document.getElementById('dateNaissance').innerText = user.dateNaissance;
                document.getElementById('pays').innerText = user.pays;
                document.getElementById('description').innerText = user.description;
                document.getElementById('taille').innerText = user.taille;
                document.getElementById('poids').innerText = user.poids;
                document.getElementById('interet1').innerText = user.interet1;
                document.getElementById('sport').innerText = user.sport;
                document.getElementById('couleurCheveux').innerText = user.couleurCheveux;
                document.getElementById('couleurYeux').innerText = user.couleurYeux;

                var roleXhr = new XMLHttpRequest();
                roleXhr.open('GET', '../PHP/roleactuel.php', true);
                roleXhr.onload = function() {
                    if (roleXhr.status === 200) {
                        var userRole = roleXhr.responseText;
                        if (userRole === 'premium' || userRole === 'admin') {
                            document.getElementById('nomComplet').innerText = user.nom;
                            document.getElementById('adresse').innerText = user.adresse;
                            document.getElementById('Prive').style.display = 'block';
                        } 
                        else {
                            document.getElementById('Prive').style.display = 'none';
                        }
                    } 
                    else {
                        console.error('Erreur de chargement du rôle utilisateur:', roleXhr.statusText);
                    }
                };
                roleXhr.onerror = function() {
                    console.error('Erreur de requête AJAX pour obtenir le rôle utilisateur');
                };
                roleXhr.send();
            } 
            else {
                window.location.href = "../HTML/accueil_apres_connexion.html";
            }
        });
    </script>
</body>
</html>
